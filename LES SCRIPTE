#!/bin/bash

# === Configuration ===
# Liste des IP internes des EC2 privées
PRIVATE_HOSTS=("172.31.25.70" "172.31.25.80")

# Clé privée SSH si nécessaire (décommente si tu utilises un fichier clé dédié)
# SSH_KEY="/home/ubuntu/.ssh/aws_rsa"

# === Supervision ===
echo "=== DÉBUT DE SUPERVISION $(date) ==="

for HOST in "${PRIVATE_HOSTS[@]}"; do
    echo "------ Supervision de $HOST ------"
    ssh -o StrictHostKeyChecking=no ubuntu@$HOST <<EOF
echo "[UPTIME]"
uptime

echo "[ESPACE DISQUE]"
df -h

echo "[PORTS OUVERTS]"
netstat -tuln
EOF
    echo ""
done

echo "=== FIN DE SUPERVISION $(date) ==="





Documenter l’environnement local

Crée un fichier ENV_LOCAL.md avec les infos suivantes :

echo "## ENVIRONNEMENT LOCAL VM" > ENV_LOCAL.md
echo "Nom de la VM : $(hostname)" >> ENV_LOCAL.md
echo "Adresse IP : $(hostname -I | awk '{print $1}')" >> ENV_LOCAL.md
echo "Version Ubuntu :" >> ENV_LOCAL.md
lsb_release -a >> ENV_LOCAL.md
echo "Interface réseau utilisée :" >> ENV_LOCAL.md
ip a | grep inet >> ENV_LOCAL.md

cat <<EOF > ENV_LOCAL.md
# ENVIRONNEMENT LOCAL

**Nom de la VM :**
$(hostname)

**Adresse IP locale :**
$(hostname -I | awk '{print $1}')

**Version d'Ubuntu :**
$(lsb_release -d | cut -f2)

**Interface réseau utilisée :**
$(ip -o -4 addr show | awk '{print $2 ": " $4}')

**Date de génération :**
$(date)

**Nom d’utilisateur actuel :**
$(whoami)
EOF
